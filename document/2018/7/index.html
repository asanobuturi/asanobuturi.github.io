<!doctype html><html lang=ja><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=description content="いろいろな物理・数学に関することを部員が語ります。"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=/css/styles.css><link rel=subresource class=lazy-css href=/css/highlight.css><link rel=icon href=/image/favicon.svg type=image/svg+xml><link rel="icon alternate" href=/images/favicon.ico><meta property="og:site_name" content="浅野学園物理部"><meta property="og:url" content="https://asanobuturi.github.io/document/2018/7/index.html"><meta property="og:title" content="ゲームプログラミングと数学が出会う時｜浅野学園物理部"><meta property="og:description" content="いろいろな物理・数学に関することを部員が語ります。"><meta property="og:type" content="website"><meta property="og:image" content="https://asanobuturi.github.io/thumbnails/document/2018/7/thumbnail.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@Uchi54_APC"><script src=/general.js></script><link rel=stylesheet href=/css/article.css><link rel=stylesheet href=/css/tableOfContents.css><script src=https://kit.fontawesome.com/1e291c4f9b.js crossorigin=anonymous></script><title>ゲームプログラミングと数学が出会う時｜浅野学園物理部</title><script type=text/javascript async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML"></script></head><body><div id=nav-drawer><input id=nav-input type=checkbox class=nav-unshown>
<label id=nav-open for=nav-input><span class="bar bar1"></span><span class="bar bar2"></span><span class="bar bar3"></span><span class=menu>MENU</span>
<span class=close>CLOSE</span></label>
<label id=nav-close for=nav-input></label><div id=nav-content><a href=/index.html><img loading=lazy src=/image/favicon.svg id=nav-logo alt=浅野学園物理部></a>
<a class=nav-link href=/index.html>ホーム</a>
<a class=nav-link href=/about/index.html>物理部とは</a>
<a class="nav-link isActive" href=/document/index.html>部誌</a>
<a class=nav-link href=/game/index.html>ゲーム</a>
<a class=nav-link href=/blog/index.html>ブログ</a>
<a class=nav-link href=/electronic/index.html>電工の部屋</a><div class=nav-separator></div><a class=nav-link href=http://d.hatena.ne.jp/apc/>ブログ(外部サイト)</a></div></div><main><div id=main><div class=documentcontent><div id=breadcrumbs><a href=/index.html><img src=/image/icons/home-solid.svg class=inline-icon>ホーム</a>
<i class="fas fa-angle-right"></i><a href=../../index.html>部誌</a>
<i class="fas fa-angle-right"></i><a href=../index.html>2018年度部誌</a>
<i class="fas fa-angle-right"></i><a href=./index.html>ゲームプログラミングと数学が出会う時</a></div><header class=documenttitle><h1 id=title>ゲームプログラミングと数学が出会う時</h1><p class=author><img src=/image/icons/user-edit-solid.svg class=inline-image>中野</p><a href="https://twitter.com/intent/tweet?text=%e3%82%b2%e3%83%bc%e3%83%a0%e3%83%97%e3%83%ad%e3%82%b0%e3%83%a9%e3%83%9f%e3%83%b3%e3%82%b0%e3%81%a8%e6%95%b0%e5%ad%a6%e3%81%8c%e5%87%ba%e4%bc%9a%e3%81%86%e6%99%82&via=Uchi54_APC&related=Uchi54_APC" class=twitter-share-button data-show-count=false>ツイート</a>
<script async src=https://platform.twitter.com/widgets.js></script></header><div class=document><p>シューティングゲームばかり作っている中２の中野です。今回はいろいろな物理・数学に関することをここに記したいと思います（内容は至って真面目です。期待しないでください）。</p><h2 id=微分の基礎>微分の基礎</h2><p>第一章では微分の基本中の基本について説明します。まず、微分とは読んで字の如く“微小部分で考える”ということです。たとえば正比例などのグラフの場合は直線なので、傾きが一定です（傾きの求め方：\( \frac{𝛥𝑦}{𝛥𝑥} \)（ここの𝛥というのは変化量という意味です））。しかし直線じゃない線を考えた場合に、\(𝛥𝑥\)の範囲を変えると\(𝛥𝑦\)が変わってしまいます。では例として
\( 𝑦 = 4.9𝑥2 \)
を考えてみましょう。</p><ul><li style="list-style:decimal outside">x=2 から x=3 の変化を考える場合</li>\[ \frac{𝛥𝑦}{𝛥𝑥} = \frac{(4.9 × 3 × 3) - (4.9 × 2 × 2)}{3 - 2} = 44.1 - 19.6 = 24.5 \]<li style="list-style:decimal outside">x=2 から x=4 の範囲を考える場合</li>\[ \frac{𝛥𝑦}{𝛥𝑥} = \frac{(4.9 × 4 × 4) - (4.9 × 2 × 2)}{4 - 2} = 29.4 \]</ul><p>上記より𝛥𝑥の範囲によって傾きが違うことがわかります。では、いよいよ本題に入りましょう。上記の変数を使って考えてみましょう。\(𝑥 = 2\)から\(𝑥 = 2 + ℎ\)の範囲まで考えることにしましょう。</p>\[ \frac{𝛥𝑦}{𝛥𝑥} = \frac{4.9(2 + ℎ)^2 - 4.9 × 2^2}{(2 + ℎ) - 2} = \frac{19.6ℎ + 4.9ℎ^2}{ℎ} = 19.6 + 4.9ℎ \]<p>微分とは“微小部分で考える”という意味でした。要はここで言う\(𝛥𝑥 = ℎ\)を極限まで小さくする（0に限りなく近づける）ということです。このℎを限りなく0に近づけることを数学で</p>\[ \lim_{h \to 0} 19.6 + 4.9ℎ = 19.6 \]<p>この19.6のことを俗に“微分係数”とよびます。ここまで微分の導入（基本中の基本）をやってきました。これで数学に興味のある人が増えたら幸いです。</p><h2 id=ゲームにおける重力の考え方>ゲームにおける重力の考え方</h2><p>皆さんはマ○オとかのゲームでジャンプするシーンを知っていますよね。本章ではそのようなゲームにおける、ジャンプのプログラムについて考えてみましょう。まず有名なこちらの2式を見てください。</p><figure>\[ y_t = ν_0t - \frac{1}{2} gt^2 \]
\[ ν^2 - ν^2_0 = -2gy_{max} \]<figcaption aria-hidden=true>\(𝑦𝑚𝑎𝑥 = 最高点[𝑚]\) , \(𝑦𝑡 = 時間によって変化する𝑦座標\) , \(𝑣 = 時間によって変化する物体の速さ\), \(𝑣_0 = 物体の初速度\), \(𝑔 = 9.8[𝑚/𝑠2]\) (重力加速度), \(𝑡 = 時間\)</figcaption></figure><p>基本的にはこれで求めることができます。しかし、プログラミングでは初速度を考えづらい状況がほとんどですよね。よって速さの概念を無くしましょう。移項などを繰り返すと、結局\( y_t = \sqrt{2gy_{max}t} - \frac{1}{2}gt^2 \)という式が作れます。ではこれをプログラミングで表現してみましょう。ちなみに言語はC言語、テキストエディタ・デバッガはVisual Studio 2017 Community、ライブラリはDXライブラリを使っています。Visual StudioはMicrosoft社から無料でダウンロードできます。<a href=https://docs.microsoft.com/ja-jp/visualstudio/install/install-visual-studio>ここ</a>に詳しいことが書いてあります。DX ライブラリは「画像を表示する」とか「特定のキーを監視する」ときに便利なライブラリです。詳しいことは<a href=http://dxlib.o.oo7.jp/>ここ</a>からどうぞ。ではこれをプログラミングで表現してみましょう。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=color:#75715e>#include</span> <span style=color:#75715e>DxLib.h</span><span style=color:#75715e>
</span><span style=color:#75715e>#include</span> <span style=color:#75715e>&amp;lt;math.h&amp;gt;</span><span style=color:#75715e>
</span><span style=color:#75715e>#define g 9.8067
</span><span style=color:#75715e>#define y_max 2.000
</span><span style=color:#75715e></span><span style=color:#66d9ef>int</span> x <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
<span style=color:#66d9ef>int</span> y <span style=color:#f92672>=</span> <span style=color:#ae81ff>480</span>;
<span style=color:#66d9ef>int</span> time1;
<span style=color:#66d9ef>int</span> time2;
<span style=color:#66d9ef>double</span> t;
<span style=color:#66d9ef>int</span> flag <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
<span style=color:#66d9ef>int</span> WINAPI <span style=color:#a6e22e>WinMain</span>(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, <span style=color:#66d9ef>int</span> nCmdShow) {
    ChangeWindowMode(TRUE);
    <span style=color:#66d9ef>if</span> (DxLib_Init() <span style=color:#f92672>==</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) {
        <span style=color:#66d9ef>return</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>;
    }
    <span style=color:#66d9ef>while</span> (CheckHitKey(KEY_INPUT_ESCAPE) <span style=color:#f92672>==</span> FALSE <span style=color:#f92672>&amp;&amp;</span> ProcessMessage() <span style=color:#f92672>!=</span> <span style=color:#f92672>-</span>) {
        <span style=color:#66d9ef>if</span> (CheckHitKey(KEY_INPUT_SPACE) <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>&amp;&amp;</span> flag <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) {
            flag <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
            time1 <span style=color:#f92672>=</span> GetNowCount();
        }
        <span style=color:#66d9ef>if</span> (flag <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>) {
            DrawPixel(x, <span style=color:#ae81ff>480</span> <span style=color:#f92672>-</span> y, GetColor(<span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>255</span>));
            time2 <span style=color:#f92672>=</span> GetNowCount();
            t <span style=color:#f92672>=</span> (<span style=color:#66d9ef>double</span>)(time2 <span style=color:#f92672>-</span> time1) <span style=color:#f92672>/</span> <span style=color:#ae81ff>1000.000</span>;
            x <span style=color:#f92672>+=</span> <span style=color:#ae81ff>6</span>;
            y <span style=color:#f92672>=</span> (<span style=color:#66d9ef>int</span>)((sqrt(<span style=color:#ae81ff>2.000</span> <span style=color:#f92672>*</span> g <span style=color:#f92672>*</span> y_max) <span style=color:#f92672>*</span> t <span style=color:#f92672>-</span> <span style=color:#ae81ff>0.500</span> <span style=color:#f92672>*</span> g <span style=color:#f92672>*</span> t <span style=color:#f92672>*</span> t) <span style=color:#f92672>*</span> <span style=color:#ae81ff>480.000</span> <span style=color:#f92672>/</span> y_max);
        }
        <span style=color:#66d9ef>if</span> (y <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>) {
            ClearDrawScreen();
            flag <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
            y <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
            x <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
        }
        ScreenFlip();
    }
    DxLib_End();
    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
}
</code></pre></div><p>これをVisual Studioにコピペして実行してみてください。点が放物線を描いているように見えるはずです。</p><h2 id=二乗を表現する方法>二乗を表現する方法</h2><p>1 2 3 4 5 6 7 8 9...などという数を二乗するとそれぞれ 1 4 9 16 25 36 49 64 81...となりますよね？本章はこれらの数列をプログラミングで表現してみたいと思います(すごく原始的です)。まず上の数列を見ると“差”は、3 5 7 9 11 13 15 17...ですよね？そうです、2 ずつ差が増えているのです。これを再現すれば皆さんでも簡単に表現することが可能です。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdio.h&gt;;</span><span style=color:#75715e>
</span><span style=color:#75715e></span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>void</span>) {
    <span style=color:#66d9ef>int</span> a <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; <span style=color:#75715e>//二乗した数
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>int</span> b <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; <span style=color:#75715e>//二乗する前の数
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>int</span> s <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>; <span style=color:#75715e>//二乗した数たちの最初の差
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>while</span> (a <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>10000</span>) { <span style=color:#75715e>//二乗した数の上限は 10000 まで
</span><span style=color:#75715e></span>        printf(<span style=color:#e6db74>&#34;%d の二乗は%d です</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, b, a); <span style=color:#75715e>//二乗した数を表示する(改行付き)
</span><span style=color:#75715e></span>        a <span style=color:#f92672>+=</span> s; <span style=color:#75715e>//次の二乗した数に差を足す
</span><span style=color:#75715e></span>        s <span style=color:#f92672>+=</span> <span style=color:#ae81ff>2</span>; <span style=color:#75715e>//今の差に 2 を足して次の差にする
</span><span style=color:#75715e></span>        b <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>; <span style=color:#75715e>//二乗する前の数に 1 ずつ足す
</span><span style=color:#75715e></span>    }
    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
}
</code></pre></div><p>これをコピペしてVisual Studioで実行してみてください。右の図みたいなものができるはずです。</p><figure><figcaption aria-hidden=true>これをコピペしてVisual Studioで実行してみてください。下の図みたいなものができるはずです。</figcaption><img src=./images/img1.jpg></figure><h2 id=展示作品>展示作品</h2><ul><li>シューティングゲーム</li><p>＜概要＞上から降ってくる緑の弾を方向キーで回避する遊び。<br>＜考察＞弾が降ってくるときに最初の方だけ、ガガガッってなる、<br>というエラーがある(未解決)。</p><li>アクションゲーム</li><p>＜概要＞Z キーで攻撃、X キーでガード、方向キーで移動。<br>＜考察＞あまり完成の目処が立っていない為、文化祭で発表されない確率が微小レベルで存在。</p><li>放物線</li><p>＜概要＞スペースキーの押下で、等間隔で放物線を描く。<br>＜考察＞本部誌の第二章参照。</p><li>スクリーンセーバー</li><p>＜概要＞物理部と書かれた楕円が色を変えながら反射する。<br>＜考察＞背景も RGB で次第に青っぽく、赤っぽくするようにした。思いの他、難しかった。また、楕円のサイズの関係上、物理部の端っこが楕円の色と重なり気持ち悪くなった。</p><figure><img src=./images/img2.jpg><figcaption aria-hidden=true>シューティングゲームの様子</figcaption></figure><p>今年の僕の部誌はこれでおしまいです。来年また部誌でお会いしましょう。</p></ul></div><nav class=nextPrev><div class=next>次へ<a href=https://asanobuturi.github.io/document/2018/8/>いったいどのくらい大きな声を出せばブラジルの人に声が届くのか＞</a></div><div class=next>前へ<a href=https://asanobuturi.github.io/document/2018/6/>投擲について＞</a></div></nav></div><nav id=sidebar><div id=sidemenu><div class=side-back><a href=../index.html>記事の一覧へもどる<img src=/image/icons/sign-out-alt-solid.svg class=inline-image></a></div><div class=side-prev><a href=https://asanobuturi.github.io/document/2018/6/><img src=/image/icons/angle-left-solid.svg class=inline-image>投擲について</a></div><div class=side-next><a href=https://asanobuturi.github.io/document/2018/8/>いったいどのくらい大きな声を出せばブラジルの人に声が届くのか<img src=/image/icons/angle-right-solid.svg class=inline-image></a></div></div><div id=indexblock><div class=indextitle>目次</div><ol class=indexcontents><nav id=TableOfContents><ul><li><a href=#微分の基礎>微分の基礎</a></li><li><a href=#ゲームにおける重力の考え方>ゲームにおける重力の考え方</a></li><li><a href=#二乗を表現する方法>二乗を表現する方法</a></li><li><a href=#展示作品>展示作品</a></li></ul></nav></ol></div></nav></div><footer class=footer><p class=copyright>Copyright &copy; 2015 - 2022 Asano Physics Club, All Rights Reversed.</p></footer></main></body></html>