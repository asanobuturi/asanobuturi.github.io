<!doctype html><html lang=ja><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=description content="今年の文化祭の主役(となるはず)だったライントレーサーの制作日記。"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=/scss/styles.min.4a71567d35f0565714f9b264f620dd2c5abcdd3fd6d8bc1fe2bafa8114c2fe47.css><link rel=icon href=/image/favicon.svg type=image/svg+xml><link rel="icon alternate" href=/image/favicon.ico><meta property="og:site_name" content="浅野学園物理部"><meta property="og:url" content="https://asanobuturi.github.io/document/2004/1/index.html"><meta property="og:title" content="ライントレーサー制作記(仮)｜浅野学園物理部"><meta property="og:description" content="今年の文化祭の主役(となるはず)だったライントレーサーの制作日記。"><meta property="og:type" content="website"><meta property="og:image" content="https://asanobuturi.github.io/document/2004/1/thumbnail.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@Uchi54_APC"><link rel=canonical href=https://asanobuturi.github.io/document/2004/1/><script async src="https://www.googletagmanager.com/gtag/js?id=G-M4YH1E5WC1"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-M4YH1E5WC1")</script><title>ライントレーサー制作記(仮)｜浅野学園物理部</title><script type=text/javascript src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<link rel=stylesheet href=/scss/highlight.min.9b4082acf90ec245e99e303a9e09c0a4ffa77b9754c98965a6bdb067c39e9c14.css><link rel=stylesheet href=/scss/article.min.5ab46a9154b676996cd1867b86fa75a6f6dfd4cf58534c093b363ff6739f3f03.css><link rel=stylesheet href=/scss/tableOfContents.min.603245923695f62c9be0618c1b6a10599acbf0f4f5056ffe631acd014b70fd17.css></head><body><nav id=nav-drawer><input id=nav-input type=checkbox class=nav-unshown>
<label id=nav-open for=nav-input><span class="bar bar1"></span>
<span class="bar bar2"></span>
<span class="bar bar3"></span>
<span class=menu>MENU</span>
<span class=close>CLOSE</span></label>
<label id=nav-close for=nav-input></label><div id=nav-content><a href=/index.html><img loading=lazy src=/image/favicon.svg id=nav-logo alt=浅野学園物理部></a>
<a class=nav-link href=/index.html>ホーム</a>
<a class=nav-link href=/about/index.html>物理部とは</a>
<a class="nav-link isActive" href=/document/index.html>部誌</a>
<a class=nav-link href=/game/index.html>ゲーム</a>
<a class=nav-link href=/blog/index.html>ブログ</a>
<a class=nav-link href=/electronic/index.html>電工の部屋</a><hr><a class=nav-link href=/credit/index.html>クレジット(ライセンス)</a></div></nav><main><div id=content><a name=top></a><div id=breadcrumbs><a href=/index.html><img src=/image/icons/home-solid.svg class=inline-image>ホーム</a>
<img src=/image/icons/angle-right-solid.svg class=inline-image>
<a href=/document/>部誌</a>
<img src=/image/icons/angle-right-solid.svg class=inline-image>
<a href=/document/2004/>2004年度部誌</a>
<img src=/image/icons/angle-right-solid.svg class=inline-image>
<a href=/document/2004/1/>ライントレーサー制作記(仮)</a></div><header id=overview><h1 id=title>ライントレーサー制作記(仮)</h1><div><div class=properties><span class=author><img src=/image/icons/user-edit-solid.svg class=inline-image>
丸川</span></div><div class=share><span><a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class=twitter-share-button data-related=Uchi54_apc data-lang=ja data-show-count=false>Tweet</a>
<script async src=https://platform.twitter.com/widgets.js></script></span></div></div></header><article><h2 id=はじめに>はじめに</h2><p>今手元に、2003年度版の部誌がある。ふと見てある事実に気がつく。なんと電子工作に関するものがないではないか。そこで、私は使命感と絶望感とともに今、キーボードを叩いています。</p><h2 id=さあ設計しよう>さあ、設計しよう</h2><p>「ライントレーサー」とは、呼んで字のごとく地面に書かれた黒いラインの通りに進んでいくという自立型ロボットです。さて、一口にそう言ってしまいましたが、どうやって黒いラインをロボットに判断させるんだ、無駄な前置き書かずに、とっと説明しろとおっしゃるかもしれません。まあそう慌てずに、順序だてて説明しましょう。</p><h3 id=センサーの話>センサーの話</h3><p>まずは、地面に書かれた(貼られた)黒いラインとそれ以外の部分を判別しなくてはなりません。そこで、登場するのは、ロボットの目ともいえるセンサーです。今回は、対象に赤外線を発光して、反射波を受け、反射光の強さに比例して、出力する反射型フォトインタラプタ<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>を使用します。なるほど、黒いラインとそれ以外(白)との反射波の強さの差を使うんだなと、聡明な皆さんは気づかれたでしょうが、その通りです。つまり、センサーが黒いライン上にあるときは、Low(電流が流れない)、それ以外(白)上にあるときは、High(電流が流れる)と言うわけです。しかし、ここからが問題です。このセンサーにどのように判定させるかが、このライントレーサーのかぎを握ります。2つのセンサーを使ってでもできる<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>のですが、それじゃおもしろくない(?)ので今回は6つのセンサーを使ってみることにしました。</p><p>では、ライントレーサーと黒いラインの位置関係の考えられる場合を図で説明したいと思います。説明の都合上、センサーを左上から順に1~6と番号を振ります。なお、進行方向は、上です。</p><div style=display:flex><p><img src=1.png alt></p><p><strong>いわゆる直線</strong><br>このときセンサーは、すべて黒いライン上には在りません。つまり、センサー1~6はすべてHigh。</p></div><div style=display:flex><p><img src=2.png alt></p><p><strong>カーブ(曲がり始め)</strong><br>このときセンサーは、センサー2のみ、黒いライン上にあります。つまり、センサー2はLow、センサー13~6はHigh。</p></div><div style=display:flex><p><img src=3.png alt></p><p><strong>カーブ(中盤)</strong><br>このときセンサーは、センサー2、6が、黒いライン上にあります。つまり、セン
サー26はLow、センサー1、3~5は、High。</p></div><div style=display:flex><p><img src=4.png alt></p><p><strong>カーブ(曲がりすぎ)</strong><br>このときセンサーは、センサー1、3、6が、黒いライン上にあります。つまりセンサー1、3、6はLow、センサー2、4、5はHigh。</p></div><p>とまあ大体こんなもんです。反対のカーブは、これの逆でいいのですが、実は、3.の場合のカーブの角度によっては、センサーの当たり方が違っていたりするのですが、このセンサーの黒いラインとの位置関係(絶対ありえないものを含む)は、2の6乗すなわち、64通り存在することになります。ちょっとセンサーの話から少し離れましょう。</p><h3 id=回路の話>回路の話</h3><p>では、何の説明かと言うとロボットの目の説明をしたので続いては、ロボットの頭とも言える電子回路について説明したいと思います。とここでほんとは、ここに回路図<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>をバンと載せればいいのだけれど、回路図をでかく書きすぎて入らなそうなので、模式的な図で説明したいと思います。ここでのセンサー1~6は、先ほどの図の位置と同じです。</p><img class=image-float-left src=5.png><p>左図がその図です。四角で囲まれた部分にはそれぞれに応じた回路が来ます。その回路の説明は今回、省略させてもらいます。(どうしても聞きたい方は丸川まで。部誌を家で読んでいる方は分からず終いなのですが。)<br>この回路のかぎは、基盤1~3に入っているPIC16F84Aと呼ばれる部品です。この部品は、IC(集積回路)と呼ばれる部品の一種で、この中にプログラムを書き込むことができ、そのプログラムによってPICの端子(部品の足)につながっているセンサーや、モーターなどを自由に動かせるものです。プログラム言語がアセンブラ<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>なので、なかなか難しく、使いづらいです。<br>では、この回路の説明をしてみましょう。まず、センサーからおのおのからそれとつながっている基盤1~3にHighかLowの信号が送られます。その送られてきた信号を基盤1、3は、基盤2に送ります。そしてそれらの信号(センサー3、4は直接)を受けて基盤2のPICが評価を下し、モーターの右、左をとめたり、動かしたりします。ちなみに、直進するときは、左右両方を動かし、右に曲がるときは、左を動かし、右を止めます。左は、逆です。聡明な方は、基盤1、3のPICは必要がないのでは、とお思いになると思いますが、これは、私の大いなる誤解のせいなのであしからず。<br>そこで先ほどのつまり、センサーの話が必要になります。先ほど述べたように、センサーの黒いラインとの位置関係(絶対ありえないものを含む)は、2の6乗すなわち、64通り存在するとなっていました。じゃあ、この64通りのときどっちに曲がるべきなのかを全通り別々に、判別していけばいいのでは、と考える方もいらっしゃるでしょうが、これはかなり大変です。それじゃあ絶対ありえないものを抜けばいいのでは、少なくなるのでは、当初はそうしようかと考えていましたが、それを調べているときにふと気づいたのです。それは、先ほど(センサーの話)の1.のときは直進、2.3.のときは、右に、4.ときは左に曲がらなければなりません。そこで、黒いライン上にあるセンサーで、右側のセンサー(2、4、6)の内Highとなったセンサーの数(1.のときは3個)から左側のセンサー(1、3、5)の内Highとなったセンサーの数を引いてみます。すると、直進するときは、差が0。右に曲がるときは、負の数。左に曲がるときは、正の数になっています。これは、多分どんなときでもいえる(全通りは調べていませんが)と思われるのでこれを利用します。これによって、場合分けが3つで済むので、ずいぶん楽になりました。</p><p>こんな感じで動かして見たいと思います。8月18日現在完成していないので、もしかしたら、動いてない状態で部誌の中だけの存在となってしまうかもしれないし、少し違ったものができるかもしれませんが、あしからず。予定は未定ですから(笑)。</p><p>ここより先は、ひまな人だけ読んでください</p><p>2.あとがきと言うか愚痴
いや一部誌をかくのに、かなりの時間が経ってしまった。現在の時刻は、8月18日6時25分。書き始めたのは、8月17日10時。はぁー。書いてるときには、オリンピック野球の日本代表は、キューバに予選で勝ってるし、巨人の工藤は200勝達成してるし、(野球のことばっか)何が悲しくて6時のニュースで・・・。すいません愚痴ばかりで。それと、私は誤字脱字王なので、多少の誤字脱字には目をつむってください。</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>赤外線の発光素子と受光素子を一体化してモジュール化した素子。秋葉原の買い物中になんと製造中止になってもはや日本にいくつ存在するかわからないものを発見し、購入。ちなみにもったいなすぎて、このライントレーサーには、もっといっぱいあるやつを使っていたりする。&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>センサー1、2の部分だけを使う方法。ようするに、1が、黒いライン上にある(Low)のときに左に曲がり、2が、黒いライン上にある(Low)のときに右に曲がり、どちらも黒いライン上にない(High)ときに直進するってこと。まあここまでの話に、ついてこれたあなたには愚問か。&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>回路図・・・回路を記号で書いたもの。ちなみに、岡田仁史さんが作られた『BSch』の作った電子回路エディター。とにかく使いやすく、パーツを新規に作れる。フリーソフトと言うのもいい。岡田仁史さんのHPは、<a href=http://www.suigyodo.com/>http://www.suigyodo.com/</a>興味がある方はどうぞ。&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p>アセンブラ・・・ハードウェアの中で使われている機械語をほんの少し人に分かるものに変えたもの。命令(人が分かる形のもの)が、35個しかないので、使いこなすのは大変。&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></article><span class=next>次へ<a href=https://asanobuturi.github.io/document/2004/2/>ラジオのススメ＞</a></span><br></div><aside id=sidebar><nav id=sidemenu><div class=side-back><a href=../index.html>記事の一覧へもどる<img src=/image/icons/sign-out-alt-solid.svg class=inline-image></a></div><div class=side-next><a href=https://asanobuturi.github.io/document/2004/2/>ラジオのススメ<img src=/image/icons/angle-right-solid.svg class=inline-image></a></div></nav><section id=indexblock><header class=indextitle>目次</header><nav id=TableOfContents><ul><li><a href=#はじめに>はじめに</a></li><li><a href=#さあ設計しよう>さあ、設計しよう</a><ul><li><a href=#センサーの話>センサーの話</a></li><li><a href=#回路の話>回路の話</a></li></ul></li></ul></nav></section></aside></main><footer id=footer><div class=section><nav class=grid><div><label class=headline>CONTENT</label><ul><li><a href=/>Home</a></li><li><a href=/document/>Docs</a></li><li><a href=/game/>Games</a></li><li><a href=/blog/>Blog</a></li><li><a href=/electronic/>Electronic</a></li></ul></div><div><label class=headline>CONTACT</label><ul><li><a target=_blank href=https://twitter.com/Uchi54_apc>Twitter</a></li><li><a target=_blank href=https://github.com/asanobuturi>GitHub Organization</a></li><li><a target=_blank href=https://github.com/asanobuturi/asanobuturi.github.io>Repository</a></li><li><a target=_blank href=https://github.com/asanobuturi/asanobuturi.github.io/issues>Issues</a></li></ul></div><div><label class=headline>ABOUT</label><ul><li><a href=/about/>About Us</a></li></ul></div></nav></div><hr><div class=section><p class=copyright>Copyright &copy; 2015 - 2023 Asano Physics Club, All Rights Reversed.</p><nav class=sns><a target=_blank href=https://twitter.com/Uchi54_apc><svg xmlns="http://www.w3.org/2000/svg" fill="currentcolor" viewBox="0 0 248 204"><path d="M221.95 51.29c.15 2.17.15 4.34.15 6.53.0 66.73-50.8 143.69-143.69 143.69v-.04c-27.44.04-54.31-7.82-77.41-22.64 3.99.48 8 .72 12.02.73 22.74.02 44.83-7.61 62.72-21.66-21.61-.41-40.56-14.5-47.18-35.07 7.57 1.46 15.37 1.16 22.8-.87-23.56-4.76-40.51-25.46-40.51-49.5v-.64c7.02 3.91 14.88 6.08 22.92 6.32C11.58 63.31 4.74 33.79 18.14 10.71c25.64 31.55 63.47 50.73 104.08 52.76-4.07-17.54 1.49-35.92 14.61-48.25 20.34-19.12 52.33-18.14 71.45 2.19 11.31-2.23 22.15-6.38 32.07-12.26-3.77 11.69-11.66 21.62-22.2 27.93 10.01-1.18 19.79-3.86 29-7.95-6.78 10.16-15.32 19.01-25.2 26.16z"/></svg></a><a target=_blank href=https://github.com/asanobuturi><svg class="w-5 h-5" fill="currentcolor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483.0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951.0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65.0.0.84-.27 2.75 1.026A9.564 9.564.0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688.0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855.0 1.338-.012 2.419-.012 2.747.0.268.18.58.688.482A10.019 10.019.0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"/></a></nav></div></footer></body></html>