<!doctype html><html lang=ja><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=description content="シンプルな級数とPythonを使って円周率を求めます。証明はムズカシイ！？"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=/scss/styles.min.7cd3d1799f57b044d496b6ef908a144b5396dfdad162f5891dee10878fc509c8.css><link rel=icon href=/image/favicon.svg type=image/svg+xml><link rel="icon alternate" href=/image/favicon.ico><meta property="og:site_name" content="浅野学園物理部"><meta property="og:url" content="https://asanobuturi.github.io/document/2021/2/index.html"><meta property="og:title" content="バーゼル級数を用いた円周率の計算｜浅野学園物理部"><meta property="og:description" content="シンプルな級数とPythonを使って円周率を求めます。証明はムズカシイ！？"><meta property="og:type" content="website"><meta property="og:image" content="https://asanobuturi.github.io/document/2021/2/thumbnail.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@Uchi54_APC"><title>バーゼル級数を用いた円周率の計算｜浅野学園物理部</title><script type=text/javascript src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><link rel=stylesheet href=/scss/highlight.min.541c5e1e7367be307434346380a9d7ef4b5d1cbf81b620162f2ae2a81b388d8e.css><link rel=stylesheet href=/scss/article.min.5ab46a9154b676996cd1867b86fa75a6f6dfd4cf58534c093b363ff6739f3f03.css><link rel=stylesheet href=/scss/tableOfContents.min.831bbd24a80ab76da8e4ce71a22f6e780bab8a66e99dc823c9d5e56378e43180.css></head><body><nav id=nav-drawer><input id=nav-input type=checkbox class=nav-unshown>
<label id=nav-open for=nav-input><span class="bar bar1"></span><span class="bar bar2"></span><span class="bar bar3"></span><span class=menu>MENU</span>
<span class=close>CLOSE</span></label>
<label id=nav-close for=nav-input></label><div id=nav-content><a href=/index.html><img loading=lazy src=/image/favicon.svg id=nav-logo alt=浅野学園物理部></a>
<a class=nav-link href=/index.html>ホーム</a>
<a class=nav-link href=/about/index.html>物理部とは</a>
<a class="nav-link isActive" href=/document/index.html>部誌</a>
<a class=nav-link href=/game/index.html>ゲーム</a>
<a class=nav-link href=/blog/index.html>ブログ</a>
<a class=nav-link href=/electronic/index.html>電工の部屋</a><hr><a class=nav-link href=/credit/index.html>クレジット(ライセンス)</a></div></nav><main><div id=content><a name=top></a><div id=breadcrumbs><a href=/index.html><img src=/image/icons/home-solid.svg class=inline-image>ホーム</a>
<img src=/image/icons/angle-right-solid.svg class=inline-image>
<a href=/document/>部誌</a>
<img src=/image/icons/angle-right-solid.svg class=inline-image>
<a href=/document/2021/>2021年度・部誌</a>
<img src=/image/icons/angle-right-solid.svg class=inline-image>
<a href=/document/2021/2/>バーゼル級数を用いた円周率の計算</a></div><header id=overview><h1 id=title>バーゼル級数を用いた円周率の計算</h1><div><div class=properties><span class=author><img src=/image/icons/user-edit-solid.svg class=inline-image>
K.N.(高1)</span></div><div class=share><span><a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class=twitter-share-button data-related=Uchi54_apc data-lang=ja data-show-count=false>Tweet</a>
<script async src=https://platform.twitter.com/widgets.js></script></span></div></div></header><article><h2 id=バーゼル級数とは>バーゼル級数とは</h2><p>\[\sum_{k=1}^{\infty}\frac{1}{k^2}=1+\frac{1}{4}+\frac{1}{9}+\cdots=\frac{\pi^2}{6}\]
これがバーゼル級数です。今回はこの級数を利用して円周率を計算していこうと思います。また、プログラミングに疎い人でも楽しめるように表現を曖昧にしていたり多少ずれていることがあります。</p><h2 id=pythonでの計算>Pythonでの計算</h2><p>今回はプログラミング言語にPythonという言語を選択しました。</p><p>Pythonは文法が比較的簡単でわかりやすく、優れたツールの豊富さが魅力の言語です(もちろん文法が比較的に簡単といえどもしっかり理解しようと思うととても時間がかかります)。</p><p>デメリットとしては、仕様上比較的実行に時間が掛かり、用途によっては向かないことなどが挙げられます。</p><h3 id=pythonの実行環境>Pythonの実行環境</h3><p>Python 3.8.2 64bit</p><h3 id=ソースコード>ソースコード</h3><p>方法としては左辺を計算しそれを6倍して√を取るのですが、\(\frac{1}{k^2}\)を\(k = 1\)から無限に足し続けることは不可能なので、今回は\(k = 100, 000, 000\)まで足し続けたいと思います。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>from</span> math <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
<span style=color:#75715e>#桁の多い小数を正確に扱うためのツールを利用する</span>
<span style=color:#f92672>from</span> decimal <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
<span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
    <span style=color:#75715e>#変数sumを定義</span>
    sum<span style=color:#f92672>=</span>Decimal(<span style=color:#ae81ff>0</span>)
    <span style=color:#75715e>#k=1からk=100000000まで</span>
    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>100000000</span>):
        <span style=color:#75715e>#1/k^2を計算してsumに加える</span>
        sum <span style=color:#f92672>+=</span> Decimal(<span style=color:#ae81ff>1</span>)<span style=color:#f92672>/</span>((Decimal(i)<span style=color:#f92672>+</span>Decimal(<span style=color:#ae81ff>1</span>))<span style=color:#f92672>**</span><span style=color:#ae81ff>2</span>)
    <span style=color:#75715e>#級数の左辺の結果を6倍し√をとる</span>
    pi <span style=color:#f92672>=</span> Decimal(sum<span style=color:#f92672>*</span><span style=color:#ae81ff>6</span>)<span style=color:#f92672>.</span>sqrt()
    <span style=color:#75715e>#結果を表示</span>
    <span style=color:#66d9ef>print</span>(pi)
</code></pre></td></tr></table></div></div><h3 id=実行結果>実行結果</h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>3.141592644040496686182218894
</code></pre></td></tr></table></div></div><p>これだけではどれだけ正確に計算できているのか分かりづらいので、合っている桁に色を付けてみたいと思います。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>from</span> math <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
<span style=color:#75715e>#桁の多い小数を正確に扱うためのツールを利用する</span>
<span style=color:#f92672>from</span> decimal <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
<span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
    <span style=color:#75715e>#変数sumを定義</span>
    sum<span style=color:#f92672>=</span>Decimal(<span style=color:#ae81ff>0</span>)
    <span style=color:#75715e>#k=1からk=100000000まで</span>
    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>100000000</span>):
        <span style=color:#75715e>#1/k^2を計算してsumに加える</span>
        sum <span style=color:#f92672>+=</span> Decimal(<span style=color:#ae81ff>1</span>)<span style=color:#f92672>/</span>((Decimal(i)<span style=color:#f92672>+</span>Decimal(<span style=color:#ae81ff>1</span>))<span style=color:#f92672>**</span><span style=color:#ae81ff>2</span>)
    <span style=color:#75715e>#級数の左辺の結果を6倍し√をとる</span>
    pi <span style=color:#f92672>=</span> Decimal(sum<span style=color:#f92672>*</span><span style=color:#ae81ff>6</span>)<span style=color:#f92672>.</span>sqrt()
    <span style=color:#75715e>#結果を表示</span>
    <span style=color:#66d9ef>print</span>(pi)
</code></pre></td></tr></table></div></div><h3 id=実行結果2>実行結果2</h3><p><img src=./result.webp alt=実行結果2></p><p>小数点以下7桁まで合っているのがわかります。</p><h2 id=バーゼル級数の証明>バーゼル級数の証明</h2><p>ここからは先程のバーゼル級数の証明をしていくのですが、正直このあたりはネット等で情報が山ほどあるのでそちらを見ていただいたほうがわかりやすいと思います(そもそもこの部誌の証明はネットで調べたものとほぼ変わりませんし)。</p><h3 id=バーゼル級数が収束することの証明>バーゼル級数が収束することの証明</h3><p>\(
\begin{align*}
1+\frac{1}{2^2}+\frac{1}{3^2}+\cdots+\frac{1}{n^2} &< 1+\frac{1}{1\cdot2}+\frac{1}{2\cdot3}+\cdots+\frac{1}{(n-1)n}\\&=1+(1-\frac{1}{2})+(\frac{1}{2}-\frac{1}{3})+\cdots+(\frac{1}{n-1}-\frac{1}{n})\\&=2-\frac{1}{n}\end{align*}\\よりこの級数は2以下に収束する
\)</p><h3 id=0le-x-le-fracpi2においてsinxxtanxとなることの証明>\(0\le x \le \frac{\pi}{2}\)において\(\sin{x} ≤ x ≤ \tan{x}\)となることの証明</h3><p><img src=./zukei.webp class=img-right width=160 alt=図></p><p>\(
図において三角形ABC < 扇型OAB < 三角形OBCが成り立つ\\すなわち\frac{1}{2}\sin{x}<\frac{1}{2}x<\frac{1}{2}\tan{x}\\よって\sin{x}< x < \tan{x}\\x=0のとき\sin{x}=0,\tan{x}=0\\x=\frac{\pi}{2}のとき\sin{x}=1である\\よって命題は示された
\)</p><h3 id=ドモアブルの定理の証明>ド・モアブルの定理の証明</h3><p>\(
(\cos{\theta}+i\sin{\theta})^n=\cos{n\theta}+i\sin{n\theta}を示す\\n=1のときは自明である\\n=kのとき成り立つと仮定すると\\ \begin{align*}(\cos{\theta}+i\sin{\theta})^{k+1}&=(\cos{\theta}+i\sin{\theta})^k(\cos{\theta}+i\sin{\theta})\\&=(\cos{k\theta}+i\sin{k\theta})(\cos{\theta}+i\sin{\theta})\\&=(\cos{k\theta}\cos{\theta}-\sin{k\theta}\sin{\theta})+i(\sin{k\theta}\cos{\theta}+\cos{k\theta}\sin{\theta})\\&(加法定理より)\\&=\cos{(k+1)}\theta+i\sin{(k+1)}\theta\end{align*}\\であるからn=kが成り立てばn=k+1でもなりたつ\\よって示された
\)</p><h3 id=バーゼル級数の証明-1>バーゼル級数の証明</h3><p>\(
k=1,2,\cdots,nに対し\theta_k=\frac{k\pi}{2n+1}とする\\すると0\le\theta_k\le\frac{\pi}{2}より\sin{\theta_k}\le\theta_k\le\tan{\theta_k}となる\\各辺の逆数をとって二乗すると\\\frac{1}{\tan^2{\theta_k}}\le\frac{(2n+1)^2}{k^2\pi^2}\le\frac{1}{\sin^2{\theta_k}}\\これをk=1からnまで足し合わせる\\\frac{\pi^2}{(2+\frac{1}{n})^2n^2}\sum_{k=1}^{n}\frac{1}{\tan^2{\theta_k}}\le\sum_{k=1}^{n}\frac{1}{k^2}\le{\frac{\pi^2}{(2+\frac{1}{n})^2}}(\frac{1}{n}+\frac{1}{n^2}\sum_{k=1}^{n}\frac{1}{tan^2\theta_k})\cdots(1)\\S_n=\sum_{k=1}^{n}\frac{1}{\tan^2\theta_k}とする\\\sin{(2n+1)}\theta_k=0より\\z=(\cos{\theta_k+i\sin{\theta_k}})^{2n+1}の虚部は0であり\\また、\sin{\theta_k}\neq0であるからzを\sin^{2n+1}\theta_kで割ると\\z'={(\frac{1}{\tan{\theta_k}}+i)}^{2n+1}の虚部は0である
このz'の虚部は\frac{1}{\tan^2{\theta_k}}のn次多項式とみなせる\\このn次多項式をf(x)=a_{n}x^n+a_{n-1}x^{n-1}+\cdots+a_{0}=0とすると\\ k=1,2,\cdots,nに対してf(\frac{1}{\tan^2{\theta_k}})=0である\\n次方程式の解と係数の関係よりS_{n}=-\frac{a_{n-1}}{a_n}\\二項定理を用いてa_n=2n+1,a_{n-1}=-\frac{(2n+1)(2n)(2n-1)}{6}であるから\\S_n=\frac{n(2n-1)}{3}\\よって\lim_{n \to \infty}\frac{S_n}{n^2}=\frac{2}{3}であるから(1)式においてはさみうちの原理より\\\sum_{k=1}^n\frac{1}{k^2}=\frac{\pi^2}{2^2}\cdot\frac{2}{3}=\frac{\pi^2}{6}
\)</p><h4 id=参考>参考</h4><ul class=li-normal><a href=https://manabitimes.jp/math/878><li>https://manabitimes.jp/math/878</li></a><a href=https://manabitimes.jp/math/689><li>https://manabitimes.jp/math/689</li></a><a href=https://manabitimes.jp/math/1315><li>https://manabitimes.jp/math/1315</li></a></ul></article><span class=next>次へ<a href=https://asanobuturi.github.io/document/2021/3/>ゲームのBGMについて＞</a></span><br><span class=prev>前へ<a href=https://asanobuturi.github.io/document/2021/1/>部長挨拶＞</a></span></div><aside id=sidebar><nav id=sidemenu><div class=side-back><a href=../index.html>記事の一覧へもどる<img src=/image/icons/sign-out-alt-solid.svg class=inline-image></a></div><div class=side-prev><a href=https://asanobuturi.github.io/document/2021/1/><img src=/image/icons/angle-left-solid.svg class=inline-image>部長挨拶</a></div><div class=side-next><a href=https://asanobuturi.github.io/document/2021/3/>ゲームのBGMについて<img src=/image/icons/angle-right-solid.svg class=inline-image></a></div></nav><section id=indexblock><header class=indextitle>目次</header><nav id=TableOfContents><ul><li><a href=#バーゼル級数とは>バーゼル級数とは</a></li><li><a href=#pythonでの計算>Pythonでの計算</a><ul><li><a href=#pythonの実行環境>Pythonの実行環境</a></li><li><a href=#ソースコード>ソースコード</a></li><li><a href=#実行結果>実行結果</a></li><li><a href=#実行結果2>実行結果2</a></li></ul></li><li><a href=#バーゼル級数の証明>バーゼル級数の証明</a><ul><li><a href=#バーゼル級数が収束することの証明>バーゼル級数が収束することの証明</a></li><li><a href=#0le-x-le-fracpi2においてsinxxtanxとなることの証明>\(0\le x \le \frac{\pi}{2}\)において\(\sin{x} ≤ x ≤ \tan{x}\)となることの証明</a></li><li><a href=#ドモアブルの定理の証明>ド・モアブルの定理の証明</a></li><li><a href=#バーゼル級数の証明-1>バーゼル級数の証明</a></li></ul></li></ul></nav></section></aside></main><footer id=footer><p class=copyright>Copyright &copy; 2015 - 2023 Asano Physics Club, All Rights Reversed.</p><p class=note></p></footer></body></html>