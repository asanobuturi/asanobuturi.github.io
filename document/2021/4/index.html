<!doctype html><html lang=ja><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=description content="深層強化学習を理論レベルから手作業で実装し、リバーシAIを作ります。"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=/scss/styles.min.4a71567d35f0565714f9b264f620dd2c5abcdd3fd6d8bc1fe2bafa8114c2fe47.css><link rel=icon href=/image/favicon.svg type=image/svg+xml><link rel="icon alternate" href=/image/favicon.ico><meta property="og:site_name" content="浅野学園物理部"><meta property="og:url" content="https://asanobuturi.github.io/document/2021/4/index.html"><meta property="og:title" content="深層強化学習によるリバーシAI｜浅野学園物理部"><meta property="og:description" content="深層強化学習を理論レベルから手作業で実装し、リバーシAIを作ります。"><meta property="og:type" content="website"><meta property="og:image" content="https://asanobuturi.github.io/document/2021/4/thumbnail.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@Uchi54_APC"><link rel=canonical href=https://asanobuturi.github.io/document/2021/4/><script async src="https://www.googletagmanager.com/gtag/js?id=G-M4YH1E5WC1"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-M4YH1E5WC1")</script><title>深層強化学習によるリバーシAI｜浅野学園物理部</title><script type=text/javascript src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<link rel=stylesheet href=/scss/highlight.min.9141ad816becb151cf8ba8de59090f7bd21363a83f62f10faaf55d5387e51d9e.css><link rel=stylesheet href=/scss/article.min.081b3cdbc5997940fe668ec26b2b0ce783dd885dd3a7cc2aab545fe3858b518d.css><link rel=stylesheet href=/scss/tableOfContents.min.603245923695f62c9be0618c1b6a10599acbf0f4f5056ffe631acd014b70fd17.css></head><body><nav id=nav-drawer><input id=nav-input type=checkbox class=nav-unshown>
<label id=nav-open for=nav-input><span class="bar bar1"></span>
<span class="bar bar2"></span>
<span class="bar bar3"></span>
<span class=menu>MENU</span>
<span class=close>CLOSE</span></label>
<label id=nav-close for=nav-input></label><div id=nav-content><a href=/index.html><img loading=lazy src=/image/favicon.svg id=nav-logo alt=浅野学園物理部></a>
<a class=nav-link href=/index.html>ホーム</a>
<a class=nav-link href=/about/index.html>物理部とは</a>
<a class="nav-link isActive" href=/document/index.html>部誌</a>
<a class=nav-link href=/game/index.html>ゲーム</a>
<a class=nav-link href=/blog/index.html>ブログ</a>
<a class=nav-link href=/electronic/index.html>電工の部屋</a><hr><a class=nav-link href=/credit/index.html>クレジット(ライセンス)</a></div></nav><main><div id=content><a name=top></a><div id=breadcrumbs><a href=/index.html><img src=/image/icons/home-solid.svg class=inline-image>ホーム</a>
<img src=/image/icons/angle-right-solid.svg class=inline-image>
<a href=/document/>部誌</a>
<img src=/image/icons/angle-right-solid.svg class=inline-image>
<a href=/document/2021/>2021年度・部誌</a>
<img src=/image/icons/angle-right-solid.svg class=inline-image>
<a href=/document/2021/4/>深層強化学習によるリバーシAI</a></div><header id=overview><h1 id=title>深層強化学習によるリバーシAI</h1><div><div class=properties><span class=author><img src=/image/icons/user-edit-solid.svg class=inline-image>
T.F.(高2)</span></div><div class=share><span><a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class=twitter-share-button data-related=Uchi54_apc data-lang=ja data-show-count=false>Tweet</a>
<script async src=https://platform.twitter.com/widgets.js></script></span></div></div></header><article><h2 id=はじめに>はじめに</h2><p>いわゆる<strong>AI（人工知能、artificial intelligence）</strong> というものは実はかなり定義があいまいです。比較的しっかりした説明をしそうなWikipediaでさえ、「～ともされる」「～もこう呼ばれることがある」と、なんとも歯切れの悪い説明をしています。要約して説明するなら、「『コンピューターで人間の知能を再現してみよう』という分野（またはそれの研究対象）のこと」といったところでしょうか。 『AIがこれからの社会で～』『我々の仕事はAIが～』といった言葉はよく聞きますが、多くの人はぼんやりとしたイメージしか持っていないと思います。注目されていると言われている「AI」とはどういった仕組みで、何ができて、何ができないのでしょうか。そういった疑問から自分の手で実際に簡易的なものを作ってみて理解を深めたいと思い、この記事を書きました。この記事を読んでそういったことが伝われば幸いです。</p><p>この記事は自分で理解を深め、知識を確かめるために書いたものでもあるので、何も知らない状態では理解しづらい文、数式が多く含まれると思われます。また、内容に誤りも含まれるかもしれませんので、ご了承ください。</p><h2 id=強化学習とは>強化学習とは</h2><h3 id=概要>概要</h3><p><strong>強化学習（reinforcement learning）</strong> はAIが学習をして知識を獲得する<strong>機械学習（machine learning）</strong> の手法の1つです。強化学習の特徴はその学習方法にあります。別の機械学習の手法であり、画像認識などで用いられる<strong>教師あり学習（supervised learning）</strong> と比べてみましょう。 教師あり学習では、前もって用意された問題（入力）とそれに対する解答（出力）をセットにした<strong>教師データ</strong>を使って学習を進めます。人間が何かを学ぶ時のように、自分の出した答えと解答を見比べて、誤差を修正して学習するわけです。しかし実際の場合には、学習すべき問題が多すぎる、もとになるデータベースがない、そもそもこれといった圧倒的な正解がない、といった理由で十分に教師データを用意できない場合があります。 このような場合に対応しやすいのが先ほどの強化学習という手法です。強化学習では教師データをまったく必要としません。代わりに学習をする対象である<strong>環境（environment）</strong> に対してランダムな行動を繰り返すなどして試行錯誤を重ねます。すると環境から良い行動には<strong>報酬（reward）</strong> が、悪い行動にはマイナスの報酬である<strong>罰（punishment）</strong> が与えられて、それをもとに教師データの代わりとなる知識を自ら作り出すことができます。なので、なにかのスコアといった数値的な報酬に変換しやすい要素を最大化させるなどの行動を学習したいときに有効であると言えます。また、ランダムに試した行動がうまくいったかを学習するため、人間が思ってもみなかった答えを編み出すこともあります。 今回はその強化学習の手法のうち問題解決のためにどういった行動パターンをとればよいか学習をする<strong>Q学習（Q-learning）</strong> というものについて考えてみます。</p><h3 id=q学習の仕組み>Q学習の仕組み</h3><p>Q学習ではある<strong>状態（situation）</strong> における<strong>行動（action）</strong> の評価値となる<strong>Q値（Q-Value）</strong>（統計学の用語）というものを学習します。学習を通して、ある状態でのある行動が良いかどうかを正確に判断できるようになれば、すなわち評価値であるQ値を適当に出力できるようになれば学習成功ということになります。良い行動かどうかというのは、環境から与えられる報酬（マイナス値の報酬である罰を含む）のみによって判断できるので状態\(s\)における行動\(a\)のQ値を\(Q(s,a)\)と表すと、環境から与えられる報酬\(r\)を用いて以下のように\(Q(s,a)\)を更新すればよさそうです。
\[Q(s,a)=Q(s,a)+r\]
しかし実際にすべての行動に報酬や罰を与えられることは少ないです（もし与えられるなら教師あり学習のほうが良いかもしれません）。サッカーやバスケットボールなどの球技を環境の例として考えてみましょう。これらのスポーツでは「シュートを成功させる」という行為には点（＝報酬）が与えられます。しかし、「ゴールの近くでパスを受け取る」という行動はそれ自体に対して点は与えられません。ですが、一連の流れで見ると「ゴールの近くでパスを受け取る」という行為は点に強く結びつく行動であり、高い評価を与えられるべき行動だと考えられます。なのでこういった行動を「ほぼ点が入ったようなもの」とみなして時刻\(t\)におけるQ値を次のように更新してみることにします。
\[
Q(s_{t},a)=Q(s_{t},a)+(r+maxQ(s_{t+1},a')-Q(s_{t},a))
\]
なにやらごちゃごちゃと式が増えましたが、やっていることはそこまで複雑ではありません。\(maxQ(s_{t+1},a')\)というのは時刻\(t\)に状態\(s\)で行動\(a\)をとった後に、時刻\(t+1\)においてとれる行動のQ値の最大値を表します。つまりこれまでの報酬に加えて、「高いQ値のある状態に移行すること」そのものを報酬として与えるようにしています。しかしそういった状態に移行しても必ずしもその高いQ値の行動をとれるとは限りませんし、何よりたくさん更新を繰り返していくとQ値が発散してしまうので、割引率\(\gamma (0<\gamma< 1)\)を用いて更新式を次のように変更します。
\[
Q(s_{t},a)=Q(s_{t},a)+(r+\gamma maxQ(s_{t+1},a')-Q(s_{t},a))
\]
割引率\(\gamma\)は時系列的なつながりの強い場合には1に近く、弱い場合には0に近く設定されます。これによってその後の行動との関係性の強さを設定できます。 また、実際に学習を進める場合にはすべてのQ値をランダムな値で初期化してから、「もっともQ値の高い行動をとる」などのように設定し、偶発的な報酬や罰に左右されないように何回も更新を繰り返して少しずつQ値を修正します。なので1回の更新が与える影響を減らすために学習係数\(α\)を用いて更新式を次のように変更します。
\[
Q(s_{t},a)=Q(s_{t},a)+\alpha(r+\gamma maxQ(s_{t+1},a')-Q(s_{t},a))
\]
これで一般的に用いられている更新式の完成です。上記の内容を大雑把にまとめます。</p><ul><li class=li-normal>環境によって報酬や罰が与えられる場合はその行動のQ値がそのまま決まる</li><li class=li-normal>そうでない場合は移行先の最高Q値を割り引いた値を、その行動のQ値にする</li><li class=li-normal>学習開始時はすべてのQ値はランダムに初期化され、だんだんと修正をして学習をする</li></ul><h2 id=深層学習とは>深層学習とは</h2><h3 id=概要-1>概要</h3><p>昨今のAIブームは第三次と言われていますが、その火種となったのが<strong>深層学習（ディープラーニング、deep learning）</strong> という技術です。これは主にもともとあった<strong>ニューラルネットワーク（神経網、neural network）</strong> の<strong>パーセプトロン（Perceptron）</strong> という手法を発展させたものを指します。ニューラルネットワークは人間の脳にある神経細胞のネットワークをコンピューター上で数学的に再現を試みる、というものです。ニューラルネットワークは特定の入力に対して特定の出力をするという条件を複数同時に満たすことのできる関数を作成できたりします。なのでニューラルネットワークは知能が関数で表現できることを前提にした上で、その知能を神経細胞を模した関数の集合によって再現してみるという試みとも考えられると思います。もし実在する複雑な問題に対しても関数化が完全に可能になれば、いろいろなことができるようになると考えられます。 最近になってから注目を浴びているような印象がありますが、実はニューラルネットワークの歴史自体はとても長く、人工知能研究の歴史の中でも比較的初期段階から研究されていた手法です。しかし近年のコンピューター技術の発展により<strong>ニューロン（神経細胞、neuron）</strong> の数を容易に増やすことができるようになり、より複雑なネットワークを形成することができるようになったため、ニューラルネットワークの発展的な分野である深層学習等の研究が加速したといえるでしょう。ニューロンの数を増やすだけでなく、そのネットワークの形を工夫する<strong>畳み込みニューラルネット（convolutional neural network）</strong> などの研究も進んでおり、その最たる例であるGoogleなどの画像認識等の技術には目を見張ります。</p><h3 id=ニューラルネットワークの構造>ニューラルネットワークの構造</h3><p>ニューラルネットワークはニューロンが集合して形成するものなので、まずはニューロンとは何かというところから説明します。 ニューロンはそれぞれの入力に対応する<strong>重み（weight）</strong> という係数と、<strong>しきい値（threshold）</strong> という係数をもち、複数の入力に対して計算をした結果を<strong>伝達関数（活性化関数、transfer function）</strong> に代入して主に単一の出力をします。これを数学的に表すと、
\[o=f(\sum_{i}x_{i}w_{i}-v)\]
\[（o:出力　x:入力　w:重み　v:しきい値　f:伝達関数）\]
となります。すこし分かりにくいですが強化学習の式よりもやっていることは単純です。それぞれの入力の値がどれほど出力に影響されるべきかを決定する重みと入力を掛け合わせたものが\(xw\)です。なので\(\sum_{i}x_{i}w_{i}\)というのは入力に重みをかけたものをすべて足し合わせるということなので、入力から取得できる情報を、何が重要か判断して取捨選択するという側面があります。 その合計値からしきい値を引き、伝達関数に代入したものが出力となります。しきい値には誤差などの比較的小さな情報を無視するようにする効果があります。伝達関数にはいろいろな関数が使用され、それぞれで効果は違いますが、極端に小さな値や極端に大きな値の影響を小さくするといった効果のものがあります。また、誤差逆伝播法（後述）に、この伝達関数の微分が深く関わっているため学習の精度や速度に直結する部分であると言えます。一般的には
\[y= \frac {1}{1+e^{-x}}（シグモイド関数）\]
\[y=\left\{\begin{array}{ll}x & (0 \lt x) \\0 & (x \leq 0)\end{array}\right.（ReLU関数）\]
などが用いられることが多いです。 こうして計算を行う複数個のニューロンを層状に構成し、それぞれのニューロンの出力結果を次の層のニューロンの入力にするというものが一般的にニューラルネットワークと呼ばれるものです。深層学習では、入力を受ける<strong>入力層</strong>、情報を伝える<strong>中間層</strong>、出力をする<strong>出力層</strong>などの層が3～4以上組み合わさったものを使った学習がもっとも多く見られます。また、入力層や出力層のニューロンを増やすことで、複数の入力に対して複数の出力をすることも可能です。</p><h3 id=最急降下法>最急降下法</h3><p>ニューロンの組み合わせで任意の関数を再現するには<strong>最急降下法（steepest descent）</strong>と<strong>誤差逆伝播法（backpropagation）</strong> によってそれぞれのニューロンの重みとしきい値を正しく修正することが必要です。詳しくやろうとすると必要な数学的知識が多く、少しややこしいので今回は簡単に説明しようと思います。 まず、\(x\)についての関数\(f(x)\)で、出力結果をある値に近づける方法について考えてみます。調整する前の値として\(x=n\)を代入して、出力結果を近づけたい値を\(t\)とおきます。「\(f(n)\)が\(t\)に近づくように\(n\)を変更する」ということは「\(f(n)-t\)が\(0\)に近づくように\(n\)を変更する」ということと同じなので、\[E(x)=\frac {1}{2}{\{f(x)-t\}^2}\]とおいて、ここで目標を「\(E(n)\)が\(0\)に近づくように\(n\)を変更する」に置き換えてみます。 ここで\(n\)の変更具合を決定するのに使うのが微分です。\(y=E(x)\)のグラフが以下のようになっている場合を例に考えてみます。</p><img src=./graph_a1.png style=width:70% alt=picture1><p>\(x=n\)が①である場合、\(E(n)\)の減る方向に変更すればよいので\(n\)を増やせばいいことがわかります。これは\(x=n\)で<strong>傾きが負である</strong>からです。 逆に②の場合は<strong>傾きが正である</strong>ので\(n\)は減らせばいいとわかります。 傾きは
\[\frac {\mathrm{d}E}{\mathrm{d}x}=\frac {\mathrm{d}E}{\mathrm{d}f}\frac {\mathrm{d}f}{\mathrm{d}x}=\{f(x)-t\}f'(x)\]
で求められるので定数\(\alpha(0&lt;\alpha)\)を用いて
\[n'=n-\alpha \{f(n)-t\}f'(n)\]
とすればよさそうです。この更新を何回も繰り返していくというのが最急降下法の方法です。ちなみに、この式に含まれる定数\(α\)は学習速度、精度ともに深く関わっている定数です。もし小さすぎれば、変化量が少なすぎて何回も調整し直さなければなりません。</p><img src=./graph_b1.png style=width:70% alt=picture2><p>また、先ほどの範囲で最小であった\(n=-0.9\)付近は局所的なもので、全体でみると\(n=1.3\)あたりが最小である、という <strong>局所解（local solution）</strong> についての問題も変化量が小さい場合には発生しやすくなります。 逆に、定数が大きすぎる場合には変化量が大きすぎて最適解を通り過ぎてしまい収束が遅くなります。これは\(\alpha>1\)の場合に何が起こるか、単純な\(y=x^2\)で考えるとわかりやすいです。</p><h3 id=誤差逆伝播法>誤差逆伝播法</h3><p>前項で説明した最急降下法を、関数であるニューロンが複数個組み合わさったニューラルネットワークに組み込むのが誤差逆伝播法です。説明の前に少しニューロンの式を以下のように変形してみます。
\[o=f(\sum_{i}x_{i}w_{i})\]
\[（o:出力　x:入力　w:重み　f:伝達関数）\]
3-3の式からしきい値がなくなりました。これはしきい値もある一定の入力（定数）に重みをかけたものとみなすことができるからです。 重みひとつだけを変数とみなしたとき、ニューロンは\(o=f(\sum_{i}x_{i}w_{i})\)で表され、入力\(x_{i}\)やほかの重み付き入力は定数とみなせるので（偏微分）さきほどの例に当てはめることができます。伝達関数をシグモイド関数にした場合の伝達関数の\(f(x)\)の微分は
\[f'(x)=(\frac {1}{1+e^{-x}})'=- \frac {(1+e^{-x})'}{(1+e^{-x})^2}=\frac {e^{-x}}{(1+e^{-x})^2}\]
\[=e^{-x}(\frac {1}{1+e^{-x}})^2=e^{-x}f(x)^2=\{\frac{1}{f(x)}-1\}f(x)^2=f(x)\{1-f(x)\}\]
となるので出力層の重みの更新式は、伝達関数の微分などを3-3の式に当てはめ、重みの係数である\(x_{i}\)を考慮して、
\[w_{i}'=w_{i}-\alpha (o-t)o(1-o)x_{i}\]
と考えられます。これが出力層のニューロンの最急降下法です。 ここから出力層のひとつ前の中間層のニューロンの重みを調整することを考えます。出力層とは違い、ニューロンの出力が直接誤差の式に組み込まれていないので、少し追加する必要があります。しかし基本的な考え方は先ほどとまったく同じです。誤差である\(E\)を0に近づければよいのでまずは\(E\)を中間層の重み\(w_{a}\)で偏微分してみます。
\[\frac{\partial E}{\partial w_{a}}=\frac{\partial E}{\partial o_{b}}\frac{\partial o_{b}}{\partial o_{a}}\frac{\partial o_{a}}{\partial w_{a}}=(y-t)(1-o_{b})o_{b}w_{b}(1-o_{a})o_{a}x_{a}\]
\[(x_{a},w_{a},o_{a}:中間層の入力、重み、出力　x_{b},w_{b},o_{a}:出力層の入力、重み、出力\]
\[E:出力層の誤差　t：目標値 )\]
なので中間層の重みの更新式は次のようにすればいいとわかります。
\[w_{a}'=w_{a}-\alpha (y-t)(1-o_{b})o_{b}w_{b}(1-o_{a})o_{a}x_{a}\]
また、さらに層が重なっていく場合にはさらにそれぞれの微分を加えればよいです。 こういった式がまさに誤差逆伝播法の中身であり、この方法では、微分によって出力層の誤差がそれぞれのニューロンに逆行して伝搬されていると言えます。</p><h2 id=深層強化学習とは>深層強化学習とは</h2><h3 id=強化学習の課題>強化学習の課題</h3><p>強化学習はさまざまな課題に対処できる手法ではありますが、実際の問題にすんなりと適応できるかというとそうではありません。大きな課題のうちの1つに「多すぎる状態を保存しきれない」というものがあります。Q学習において、すべてのQ値は状態と行動を対応させた状態で保存されます。単純な問題であれば、保存すべき状態も行動の選択肢も少ないために簡単に保存できます。しかしボードゲームなどの比較的単純な問題でさえ、数手進めるだけで何億通りもの盤面があり、現在のメモリでは保存しきることができません。（将来的に技術が進歩すれば解決できる問題というわけでもありません）実際の問題だったらなおさらです。Q値の保存ができなければもちろんQ学習を進めることはできません。この問題を解決するのに役立つのがニューラルネットワークです。</p><h3 id=ニューラルネットワークによる解決>ニューラルネットワークによる解決</h3><p>ニューラルネットワークは複数の入力に対して特定の出力をするように学習でき、これは複数の変数をもつ任意の関数の疑似的な模倣ができるといいかえられます。なので先ほどの問題は、状態を複数の変数で表現し、Q値を出力する関数をニューラルネットワークによって学習することで解決できると考えられます。具体的な例で考えてみましょう。 先ほどと同じようにサッカーやバスケットボールといったスポーツで一プレーヤーについての行動を例にしてみましょう。こういった球技で変数として表すのがよさそうな要素をリストアップしてみます。</p><ul><li class=li-normal>自分の位置、速度</li><li class=li-normal>味方と敵の位置、速度</li><li class=li-normal>ボールの位置、速度</li><li class=li-normal>残り時間</li></ul><p>これらは数値で表現可能な情報なので変数として扱うことができます。これらの入力に対して、「前に進む」などについての評価値を算出し、それに基づき行動を行います。そして行動をとってから報酬や罰によってQ値を修正します。この場合、Q値はニューラルネットワークによって構成されるひとつの関数の計算結果として表現されるので、さきほどのニューロンの重みを修正することによって任意の出力に修正できます。つまり、知識をニューロンの重みとして蓄積することができるということです。</p><h2 id=深層強化学習によるゲームai>深層強化学習によるゲームAI</h2><h3 id=リバーシについて>リバーシについて</h3><p>リバーシは白と黒が一面ずつある石と、8×8マスに区切られている盤を使って2人でプレイされる完全情報ゲームです。とても有名ですが主なルールを明文化しておきます。</p><ul><li class=li-normal>プレイヤーは基本的に交互に1つずつ石を置いていく</li><li class=li-normal>自分の番に置く石は、置いてある自分の石と相手の石を直線的に挟めるマスにのみ置くことができる</li><li class=li-normal>置いた石と自分の石で挟まれた相手の石はすべて自分の石になり、裏返る</li><li class=li-normal>おける場所がない場合にはパスとなる</li><li class=li-normal>おける場所がある場合には必ず石をおかなくてはならない</li><li class=li-normal>相手も自分もおける場所がない場合にはゲーム終了となる</li><li class=li-normal>ゲーム終了時に石の多いプレイヤーが勝利する</li><li class=li-normal>ゲーム開始時には中央4マスにそれぞれの石が2個ずつ互い違いに置かれる</li></ul><p>今回リバーシを学習対象に選んだ理由は以下の通りです。</p><ul><li class=li-normal>8×8マスなので入力となる情報が単純すぎず複雑すぎない</li><li class=li-normal>手順通りに進めれば毎回同じ結果になる</li><li class=li-normal>ルールが単純で広く知られているゲームである</li><li class=li-normal>ほかにも人工知能でやってる方がいる</li><li class=li-normal>実際にすぐに対戦できるので強さがわかりやすい</li><li class=li-normal>ゲームの実装が複雑でない</li></ul><h3 id=学習方法について>学習方法について</h3><p>もちろん学習方法は多層パーセプトロンによる深層学習を採用しました。 詳細は以下の通りです。</p><ul><li class=li-normal>第1層～第3層からなりそれぞれの層は128、64、64個のパーセプトロンから構成される</li><li class=li-normal>練習相手となる簡易的なコンピュータープレイヤーの強さが適切になるように、そのふるまいを直近100試合の勝率を用いて以下のように設定</li></ul><pre><code class=language-text>勝率(0～1)の確率でランダムに石の置き場所を決定する
そうでない場合は半分の確率で、2手先の時点で相手の石より自分の石がなるべく多くなるようなマスに置く
そうでない場合は同様に3手先の時点で多くなるようなマスに置く</code></pre><ul><li class=li-normal><p>入力はそれぞれのマスに白が置いてあるか、黒が置いてあるか、空白であるかという状態をそれぞれ0と1で表したものに設定。つまり0または1で表される64×3=192個の要素から構成される</p></li><li class=li-normal><p>出力層はそれぞれのマスに置くことのQ値（0≦Q≦1）に設定。つまり0～1で表されるそれぞれのマスの評価値が計64個出力される</p></li><li class=li-normal><p>ニューロンとQ学習に関連する定数等は以下のように設定</p></li><table><tr><td>Q学習の学習係数</td><td>\(\alpha=0.1\)</td></tr><tr><td>割引率</td><td>\(\gamma=0.9\)</td></tr><tr><td>ニューロンの学習定数</td><td>\(\alpha=0.05\)</td></tr><tr><td>出力の誤差の許容値</td><td>\(T=19.2(0.1×192)\)</td></tr><tr><td>伝達関数</td><td>シグモイド関数</td></tr><tr><td>学習対象となる試合数</td><td>500</td></tr></table></ul><p>また、Pythonのモジュール等で手軽に実装することは可能でしたが、理解を深めるため、今回は何もない状態からC++でコーディングしました。</p><h3 id=結果>結果</h3><p>ある程度の客観的な指標になると思い、石を置ける場所からランダムに選択するコンピュータープレイヤーとの1000試合の結果をここに示しておきます。</p><table><tr><th>試行</th><th>勝ち</th><th>引き分け</th><th>負け</th></tr><tr><td>1回目</td><td>937</td><td>7</td><td>56</td></tr><tr><td>2回目</td><td>812</td><td>4</td><td>184</td></tr><tr><td>3回目</td><td>847</td><td>25</td><td>128</td></tr><tr><td>平均</td><td>865.3</td><td>12</td><td>122.7</td></tr></table><p>結果、ランダムな手に対しての勝率は9割ぐらいを予想してましたが約8割5分でした。</p><p>ちなみに人間との対戦結果は、人間がたまに負けるくらいの印象でした。</p><h2 id=おわりに>おわりに</h2><p>今回の制作を通して、その仕組みがわかり今まで朦朧としてた印象が固まりました。 また、大企業などの膨大なデータベースを用いたAIの強力さを強く実感しました。 次はより複雑な問題や実生活に密接な問題などに挑戦したいと思います。</p><h3 id=参考文献>参考文献</h3><ul><li class=li-normal>小高 知宏、『強化学習と深層学習　-C言語によるシミュレーション-』、オーム社、2017</li><li class=li-normal>『誤差逆伝播法を宇宙一わかりやすく解説してみる』、ロボット・IT雑食日記、2018/6/14、閲覧日2021/9/30<a href=https://www.yukisako.xyz/entry/backpropagation>https://www.yukisako.xyz/entry/backpropagation</a></li></ul></article><span class=next>次へ<a href=https://asanobuturi.github.io/document/2021/5/>アーキテクチャへの扉＞</a></span><br><span class=prev>前へ<a href=https://asanobuturi.github.io/document/2021/3/>ゲームのBGMについて＞</a></span></div><aside id=sidebar><nav id=sidemenu><div class=side-back><a href=../index.html>記事の一覧へもどる<img src=/image/icons/sign-out-alt-solid.svg class=inline-image></a></div><div class=side-prev><a href=https://asanobuturi.github.io/document/2021/3/><img src=/image/icons/angle-left-solid.svg class=inline-image>ゲームのBGMについて</a></div><div class=side-next><a href=https://asanobuturi.github.io/document/2021/5/>アーキテクチャへの扉<img src=/image/icons/angle-right-solid.svg class=inline-image></a></div></nav><section id=indexblock><header class=indextitle>目次</header><nav id=TableOfContents><ul><li><a href=#はじめに>はじめに</a></li><li><a href=#強化学習とは>強化学習とは</a><ul><li><a href=#概要>概要</a></li><li><a href=#q学習の仕組み>Q学習の仕組み</a></li></ul></li><li><a href=#深層学習とは>深層学習とは</a><ul><li><a href=#概要-1>概要</a></li><li><a href=#ニューラルネットワークの構造>ニューラルネットワークの構造</a></li><li><a href=#最急降下法>最急降下法</a></li><li><a href=#誤差逆伝播法>誤差逆伝播法</a></li></ul></li><li><a href=#深層強化学習とは>深層強化学習とは</a><ul><li><a href=#強化学習の課題>強化学習の課題</a></li><li><a href=#ニューラルネットワークによる解決>ニューラルネットワークによる解決</a></li></ul></li><li><a href=#深層強化学習によるゲームai>深層強化学習によるゲームAI</a><ul><li><a href=#リバーシについて>リバーシについて</a></li><li><a href=#学習方法について>学習方法について</a></li><li><a href=#結果>結果</a></li></ul></li><li><a href=#おわりに>おわりに</a><ul><li><a href=#参考文献>参考文献</a></li></ul></li></ul></nav></section></aside></main><footer id=footer><div class=section><nav class=grid><div><label class=headline>CONTENT</label><ul><li><a href=/>Home</a></li><li><a href=/document/>Docs</a></li><li><a href=/game/>Games</a></li><li><a href=/blog/>Blog</a></li><li><a href=/electronic/>Electronic</a></li></ul></div><div><label class=headline>CONTACT</label><ul><li><a target=_blank href=https://x.com/Uchi54_apc>X</a></li><li><a target=_blank href=https://github.com/asanobuturi>GitHub Organization</a></li><li><a target=_blank href=https://github.com/asanobuturi/asanobuturi.github.io>Repository</a></li><li><a target=_blank href=https://github.com/asanobuturi/asanobuturi.github.io/issues>Issues</a></li></ul></div><div><label class=headline>ABOUT</label><ul><li><a href=/about/>About Us</a></li></ul></div></nav></div><hr><div class=section><p class=copyright>Copyright &copy; 2015 - 2023 Asano Physics Club, All Rights Reversed.</p><nav class=sns><a target=_blank href=https://twitter.com/Uchi54_apc><svg xmlns="http://www.w3.org/2000/svg" fill="currentcolor" viewBox="0 0 248 204"><path d="M221.95 51.29c.15 2.17.15 4.34.15 6.53.0 66.73-50.8 143.69-143.69 143.69v-.04c-27.44.04-54.31-7.82-77.41-22.64 3.99.48 8 .72 12.02.73 22.74.02 44.83-7.61 62.72-21.66-21.61-.41-40.56-14.5-47.18-35.07 7.57 1.46 15.37 1.16 22.8-.87-23.56-4.76-40.51-25.46-40.51-49.5v-.64c7.02 3.91 14.88 6.08 22.92 6.32C11.58 63.31 4.74 33.79 18.14 10.71c25.64 31.55 63.47 50.73 104.08 52.76-4.07-17.54 1.49-35.92 14.61-48.25 20.34-19.12 52.33-18.14 71.45 2.19 11.31-2.23 22.15-6.38 32.07-12.26-3.77 11.69-11.66 21.62-22.2 27.93 10.01-1.18 19.79-3.86 29-7.95-6.78 10.16-15.32 19.01-25.2 26.16z"/></svg></a><a target=_blank href=https://github.com/asanobuturi><svg class="w-5 h-5" fill="currentcolor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483.0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951.0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65.0.0.84-.27 2.75 1.026A9.564 9.564.0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688.0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855.0 1.338-.012 2.419-.012 2.747.0.268.18.58.688.482A10.019 10.019.0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"/></a></nav></div></footer></body></html>